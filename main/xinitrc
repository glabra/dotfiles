#!/bin/sh

if test -d /etc/X11/xinit/xinitrc.d
then
   for file in /etc/X11/xinit/xinitrc.d/*
   do
      test -x "${file}" && . "${file}"
   done
   unset file
fi

export LANG='ja_JP.UTF-8'
export XMODIFIERS='@im=fcitx'
export GTK_IM_MODULE='fcitx'

# hack for various Java AWT bugs
export _JAVA_AWT_WM_NONREPARENTING=1
wmname LG3D &
# hack for beautiful looking in Java
export _JAVA_OPTIONS='-Dswing.defaultlaf=com.sun.java.swing.plaf.gtk.GTKLookAndFeel -Dawt.useSystemAAFontSettings=gasp'

# tweaks
which ssh-agent 2>&1 >/dev/null && eval $(ssh-agent)
fcitx-autostart &
xmodmap "${HOME}/.config/Xmodmap" &
xset r rate 200 45 &
synclient HorizTwoFingerScroll=1 &
xbacklight -set 20 &

which jack-alsa-interpolate >&/dev/null && (
	# initialize jack
	sleep 1 # wait for x11 initialize
	jack-alsa-interpolate
) &

which dwm-updateinfo >&/dev/null && \
	dwm-updateinfo eternal &

which feh >&/dev/null && (
	# Setup wallpaper
	feh --bg-fill --no-fehbg --randomize "${HOME}/.local/wallpapers"
) &

exec dwm

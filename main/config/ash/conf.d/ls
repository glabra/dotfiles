detect_ls_variant () {
    if is_busybox_binary 'ls'; then
        printf '%s' 'BusyBox'
    else
        local help
        if help=$(ls --help 2>&1); then
            if printf '%s' "${help}" | grep -q 'GNU coreutils'; then
                printf '%s' 'GNU'
            fi
        else
            printf '%s' 'BSD'
        fi
    fi
}

case "$(detect_ls_variant)" in
    'GNU' | 'BusyBox') alias ls='ls --color=auto' ;;
    'BSD') alias ls='ls -G' ;;
    *) ;;
esac

unset -f detect_ls_variant
